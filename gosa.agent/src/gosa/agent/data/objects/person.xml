<?xml version="1.0" encoding="UTF-8"?>
<Objects xmlns="http://www.gonicus.de/Objects">
	<Object>
		<Name>Person</Name>
		<Description>Person class</Description>
		<BackendParameters>
			<Backend objectClasses="inetOrgPerson,gosaAccount"
				RDN="cn,uid,dateOfBirth">LDAP</Backend>
		</BackendParameters>
		<Backend>LDAP</Backend>

		<Methods>
			<Method>
				<Name>notify</Name>
				<MethodParameters>
					<MethodParameter>
						<Name>notify_title</Name>
						<Type>UnicodeString</Type>
						<Default>title</Default>
					</MethodParameter>	
					<MethodParameter>
						<Name>notify_message</Name>
						<Type>UnicodeString</Type>
						<Required>true</Required>
					</MethodParameter>			
				</MethodParameters>
				<Command>notifyUser</Command>
				<CommandParameters>
					<CommandParameter>
						<Value>%(uid)s</Value>
					</CommandParameter>		
					<CommandParameter>
						<Value>Der angegebene Titel war: %(notify_title)s</Value>
					</CommandParameter>			
					<CommandParameter>
						<Value>%(notify_message)s</Value>
					</CommandParameter>		
				</CommandParameters>
			</Method>
		</Methods>

		<Attributes>
			
			<Attribute>
				<Name>uid</Name>
				<Description>User ID</Description>
				<Type>UnicodeString</Type>
				<Validators>
					<Condition>
						<Name>stringLength</Name>
						<Param>3</Param>
						<Param>-1</Param>
					</Condition>
				</Validators>
				<Mandatory>true</Mandatory>
			</Attribute>

			<Attribute>
				<Name>sn</Name>
				<Description>Surname</Description>
				<Type>UnicodeString</Type>
				<Mandatory>true</Mandatory>
			</Attribute>

			<Attribute>
				<Name>givenName</Name>
				<Description>Given name</Description>
				<Type>UnicodeString</Type>
				<Mandatory>true</Mandatory>
			</Attribute>

			<Attribute>
				<Name>telephoneNumber</Name>
				<Description>The users phone numbers</Description>
				<Type>String</Type>
				<MultiValue>true</MultiValue>
			</Attribute>

			<Attribute>
				<Name>gender</Name>
				<Description>'Gender: M for male, F for female</Description>
				<Type>String</Type>
                          	<Validators>
                                        <ConditionOperator>
                                                <Operator>or</Operator>
                                                <LeftConditionChain>
                                                        <Condition>
                                                                <Name>Equals</Name>
                                                                <Param>M</Param>
                                                        </Condition>
                                                </LeftConditionChain>
                                                <RightConditionChain>
                                                        <Condition>
                                                                <Name>Equals</Name>
                                                                <Param>F</Param>
                                                        </Condition>
                                                </RightConditionChain>
                                        </ConditionOperator>
                                </Validators>
			</Attribute>

			<Attribute>
				<Name>dateOfBirth</Name>
				<Description>Date of birth</Description>
				<Type>Date</Type>
				<BackendType>String</BackendType>
 				<InFilter>
                                        <FilterChain>
                                                <FilterEntry>
                                                        <Filter>
                                                                <Name>StringToDate</Name>
								<Param>%Y-%m-%d</Param>
                                                        </Filter>
                                                </FilterEntry>
                                        </FilterChain>
                                </InFilter>
 				<OutFilter>
                                        <FilterChain>
                                                <FilterEntry>
                                                        <Filter>
                                                                <Name>DateToString</Name>
								<Param>%Y-%m-%d</Param>
                                                        </Filter>
                                                </FilterEntry>
                                        </FilterChain>
                                </OutFilter>
			</Attribute>

			<Attribute>
				<Name>personalTitle</Name>
				<Description>Personal title</Description>
				<Type>UnicodeString</Type>
			</Attribute>

			<Attribute>
				<Name>gotoLastSystemLogin</Name>
				<Description>The last system login timestamp</Description>
				<Type>Timestamp</Type>
			</Attribute>

			<Attribute>
				<Name>jpegPhoto</Name>
				<Description></Description>
				<Type>Binary</Type>
			</Attribute>

			<Attribute>
				<Name>roomNumber</Name>
				<Description></Description>
				<Type>Integer</Type>
				<BackendType>String</BackendType>
			</Attribute>

			<Attribute>
				<Name>userPassword</Name>
				<Description>The users password</Description>
				<Type>UnicodeString</Type>
				<InFilter>
					<FilterChain>
						<FilterEntry>
							<Filter>
								<Name>Target</Name>
								<Param>passwordMethod</Param>
							</Filter>
						</FilterEntry>
						<FilterEntry>
							<Filter>
								<Name>Replace</Name>
								<Param>^{([^}]*)}.*$</Param>
								<Param>\1</Param>
							</Filter>
						</FilterEntry>
					</FilterChain>
				</InFilter>
				<OutFilter>
					<FilterChain>
						<FilterEntry>
							<Filter>
								<Name>SambaHash</Name>
							</Filter>
						</FilterEntry>
					</FilterChain>
				</OutFilter>
			</Attribute>

			<Attribute>
				<Name>cn</Name>
				<DependsOn>
					<Attribute>sn</Attribute>
					<Attribute>givenName</Attribute>
				</DependsOn>
				<Description>Common name</Description>
				<Type>UnicodeString</Type>

				<OutFilter>
					<FilterChain>
						<FilterEntry>
							<Filter>
								<Name>Clear</Name>
							</Filter>
						</FilterEntry>
						<FilterEntry>
							<Filter>
								<Name>ConcatString</Name>
								<Param>%(givenName)s %(sn)s</Param>
								<Param>left</Param>
							</Filter>
						</FilterEntry>
						<FilterEntry>
							<Filter>
								<Name>ConcatString</Name>
								<Param> (Ja es geht!)</Param>
								<Param>right</Param>
							</Filter>
						</FilterEntry>
					</FilterChain>
				</OutFilter>
				<MultiValue>false</MultiValue>
				<Mandatory>true</Mandatory>
				<Readonly>true</Readonly>
			</Attribute>
		</Attributes>

		<Container>
			<Type>Nothing</Type>
		</Container>

		<BaseObject>false</BaseObject>
	</Object>
</Objects>
